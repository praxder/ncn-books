import{a as W,b as Y,c as q,d as B,e as H,f as J}from"./chunk-L2N6OSTQ.js";import{g as z,h as Z,i as Q}from"./chunk-DZWPVE7X.js";import{c as V}from"./chunk-ZQOI7BBG.js";import{c as G}from"./chunk-PNK3MDVW.js";import"./chunk-GJAULJBT.js";import{a as M,d as F}from"./chunk-K3W4U4ZG.js";import{a as P,c as j,e as $,g as R,h as U}from"./chunk-COWIBSMX.js";import{b as K}from"./chunk-KW5VBN5V.js";import{O as A,U as D,V as N}from"./chunk-PT23TE2W.js";import"./chunk-Q64FFBLU.js";import{Hb as s,Ib as L,Jb as y,Kb as O,Pb as C,Qa as T,Ta as a,Ua as w,d as x,ha as S,ib as u,kb as l,lc as v,mc as E,pa as f,qa as g,qb as n,qc as b,rb as o,sb as I,ub as _,xb as d,ya as k,zb as p}from"./chunk-HBN3XZPF.js";function nt(e,m){if(e&1){let t=_();n(0,"mat-chip-option",5),d("click",function(){let r=f(t).$implicit,c=p();return g(c.toggleStatus(r))}),s(1),o()}if(e&2){let t=m.$implicit,i=p();l("selected",i.isSelected(t)),a(),y(" ",t," ")}}function at(e,m){if(e&1){let t=_();n(0,"button",6),d("click",function(){f(t);let r=p();return g(r.clearFilters())}),s(1," Show All "),o()}}var et=(()=>{class e{constructor(){this.selectedStatuses=[],this.statusesChanged=new k,this.availableStatuses=["Not Started","Currently Reading","Completed","Did Not Finish"]}toggleStatus(t){this.selectedStatuses.indexOf(t)>-1?this.selectedStatuses=this.selectedStatuses.filter(r=>r!==t):this.selectedStatuses=[...this.selectedStatuses,t],this.statusesChanged.emit(this.selectedStatuses)}isSelected(t){return this.selectedStatuses.includes(t)}clearFilters(){this.selectedStatuses=[],this.statusesChanged.emit(this.selectedStatuses)}get isShowingAll(){return this.selectedStatuses.length===0}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=S({type:e,selectors:[["app-filter-bar"]],inputs:{selectedStatuses:"selectedStatuses"},outputs:{statusesChanged:"statusesChanged"},standalone:!0,features:[C],decls:6,vars:3,consts:[[1,"flex","items-center","gap-2","mb-4"],[1,"text-sm","font-medium","text-gray-700"],["aria-label","Status filter",1,"flex-wrap",3,"multiple"],[3,"selected","click",4,"ngFor","ngForOf"],["mat-button","","class","ml-2",3,"click",4,"ngIf"],[3,"click","selected"],["mat-button","",1,"ml-2",3,"click"]],template:function(i,r){i&1&&(n(0,"div",0)(1,"span",1),s(2,"Filter by status:"),o(),n(3,"mat-chip-listbox",2),u(4,nt,2,2,"mat-chip-option",3),o(),u(5,at,2,0,"button",4),o()),i&2&&(a(3),l("multiple",!0),a(),l("ngForOf",r.availableStatuses),a(),l("ngIf",!r.isShowingAll))},dependencies:[b,v,E,B,q,Y,F,M]})}}return e})();function st(e,m){if(e&1&&(n(0,"mat-option",5),s(1),o()),e&2){let t=m.$implicit;l("value",t.value),a(),y(" ",t.label," ")}}var it=(()=>{class e{constructor(){this.selectedSort="recently-updated",this.sortChanged=new k,this.sortOptions=[{value:"recently-updated",label:"Recently Updated"},{value:"title-asc",label:"Title (A-Z)"},{value:"author-asc",label:"Author (A-Z)"}]}onSortChange(t){this.selectedSort=t,this.sortChanged.emit(t)}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=S({type:e,selectors:[["app-sort-selector"]],inputs:{selectedSort:"selectedSort"},outputs:{sortChanged:"sortChanged"},standalone:!0,features:[C],decls:6,vars:2,consts:[[1,"flex","items-center","gap-2"],[1,"text-sm","font-medium","text-gray-700"],["appearance","outline",1,"compact-field"],["aria-label","Sort by",3,"selectionChange","value"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(i,r){i&1&&(n(0,"div",0)(1,"span",1),s(2,"Sort by:"),o(),n(3,"mat-form-field",2)(4,"mat-select",3),d("selectionChange",function(h){return r.onSortChange(h.value)}),u(5,st,2,2,"mat-option",4),o()()()),i&2&&(a(4),l("value",r.selectedSort),a(),l("ngForOf",r.sortOptions))},dependencies:[b,v,Z,z,J,H,A],styles:[".compact-field[_ngcontent-%COMP%]{width:200px}.compact-field[_ngcontent-%COMP%]     .mat-mdc-form-field-infix{padding-top:8px;padding-bottom:8px}"]})}}return e})();function lt(e,m){e&1&&I(0,"app-loading-spinner")}function ct(e,m){if(e&1){let t=_();n(0,"div",7)(1,"app-filter-bar",8),d("statusesChanged",function(r){f(t);let c=p();return g(c.onStatusFilterChange(r))}),o(),n(2,"app-sort-selector",9),d("sortChanged",function(r){f(t);let c=p();return g(c.onSortChange(r))}),o()()}if(e&2){let t=p();a(),l("selectedStatuses",t.selectedStatuses),a(),l("selectedSort",t.selectedSort)}}function mt(e,m){if(e&1){let t=_();n(0,"div",10)(1,"mat-icon",11),s(2,"library_books"),o(),n(3,"h2",12),s(4,"Your library is empty"),o(),n(5,"p",13),s(6,"Start building your reading collection"),o(),n(7,"button",3),d("click",function(){f(t);let r=p();return g(r.goToSearch())}),n(8,"mat-icon"),s(9,"search"),o(),s(10," Search for Books "),o()()}}function pt(e,m){e&1&&(n(0,"div",10)(1,"mat-icon",14),s(2,"filter_alt_off"),o(),n(3,"h2",15),s(4,"No books match your filters"),o(),n(5,"p",16),s(6,"Try adjusting your status filters"),o()())}function dt(e,m){e&1&&(n(0,"span"),s(1," matching your filters"),o())}function ut(e,m){e&1&&(n(0,"span"),s(1," in your library"),o())}function ft(e,m){if(e&1&&(n(0,"span",30),s(1),o()),e&2){let t=p().$implicit;a(),y(" ",t.book.pageCount," pages ")}}function gt(e,m){if(e&1){let t=_();n(0,"mat-card",20),d("click",function(){let r=f(t).$implicit,c=p(2);return g(c.viewBookDetail(r.book.isbn))}),I(1,"img",21),n(2,"mat-card-content",22)(3,"h3",23),s(4),o(),n(5,"p",24),s(6),o(),n(7,"div",25)(8,"mat-chip",26),s(9),o(),u(10,ft,2,1,"span",27),o()(),n(11,"mat-card-actions",28)(12,"button",29),s(13," View Details "),o()()()}if(e&2){let t=m.$implicit,i=p(2);a(),l("src",t.book.coverImageUrl||"assets/placeholder-book.png",T)("alt",t.book.title),a(3),L(t.book.title),a(2),L(t.book.author),a(2),l("color",i.getStatusColor(t.entry.status)),a(),y(" ",t.entry.status," "),a(),l("ngIf",t.book.pageCount)}}function ht(e,m){if(e&1&&(n(0,"div")(1,"p",17),s(2),u(3,dt,2,0,"span",4)(4,ut,2,0,"span",4),o(),n(5,"div",18),u(6,gt,14,7,"mat-card",19),o()()),e&2){let t=p();a(2),O(" ",t.filteredBooks.length," book",t.filteredBooks.length!==1?"s":""," "),a(),l("ngIf",t.selectedStatuses.length>0),a(),l("ngIf",t.selectedStatuses.length===0),a(2),l("ngForOf",t.filteredBooks)}}var Ht=(()=>{class e{constructor(t,i,r){this.readingLog=t,this.storage=i,this.router=r,this.allBooks=[],this.filteredBooks=[],this.selectedStatuses=[],this.selectedSort="recently-updated",this.isLoading=!0}ngOnInit(){return x(this,null,function*(){yield this.loadPreferences(),yield this.loadBooks()})}loadPreferences(){return x(this,null,function*(){try{let t=yield this.storage.getPreference("library-status-filter");t?.value&&Array.isArray(t.value)&&(this.selectedStatuses=t.value);let i=yield this.storage.getPreference("library-sort");i?.value&&typeof i.value=="string"&&(this.selectedSort=i.value)}catch(t){console.error("Error loading preferences:",t)}})}loadBooks(){return x(this,null,function*(){this.isLoading=!0;try{this.allBooks=yield this.readingLog.getAllBooksWithEntries(),this.applyFilters()}catch(t){console.error("Error loading books:",t),this.allBooks=[],this.filteredBooks=[]}finally{this.isLoading=!1}})}applyFilters(){let t=this.allBooks;this.selectedStatuses.length>0&&(t=t.filter(i=>this.selectedStatuses.includes(i.entry.status))),this.filteredBooks=this.sortBooks(t,this.selectedSort)}sortBooks(t,i){let r=[...t];switch(i){case"title-asc":return r.sort((c,h)=>c.book.title.localeCompare(h.book.title));case"author-asc":return r.sort((c,h)=>c.book.author.localeCompare(h.book.author));case"recently-updated":default:return r.sort((c,h)=>h.entry.lastUpdated.getTime()-c.entry.lastUpdated.getTime())}}onStatusFilterChange(t){return x(this,null,function*(){this.selectedStatuses=t,this.applyFilters();try{yield this.storage.setPreference("library-status-filter",t)}catch(i){console.error("Error saving filter preference:",i)}})}onSortChange(t){return x(this,null,function*(){this.selectedSort=t,this.applyFilters();try{yield this.storage.setPreference("library-sort",t)}catch(i){console.error("Error saving sort preference:",i)}})}viewBookDetail(t){this.router.navigate(["/book",t])}goToSearch(){this.router.navigate(["/search"])}getStatusColor(t){switch(t){case"Not Started":return"default";case"Currently Reading":return"primary";case"Completed":return"accent";case"Did Not Finish":return"warn";default:return"default"}}static{this.\u0275fac=function(i){return new(i||e)(w(Q),w(K),w(V))}}static{this.\u0275cmp=S({type:e,selectors:[["app-library"]],standalone:!0,features:[C],decls:13,vars:5,consts:[[1,"container","mx-auto","p-4","max-w-7xl"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-3xl","font-bold"],["mat-raised-button","","color","primary",3,"click"],[4,"ngIf"],["class","space-y-4",4,"ngIf"],["class","text-center py-16",4,"ngIf"],[1,"space-y-4"],[3,"statusesChanged","selectedStatuses"],[3,"sortChanged","selectedSort"],[1,"text-center","py-16"],[1,"text-8xl","text-gray-300","mb-4"],[1,"text-2xl","font-semibold","mb-2"],[1,"text-gray-600","mb-6"],[1,"text-6xl","text-gray-400","mb-4"],[1,"text-xl","font-semibold","mb-2"],[1,"text-gray-600"],[1,"text-gray-600","mb-4"],[1,"grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-3","lg:grid-cols-4","xl:grid-cols-5","gap-4"],["class","cursor-pointer hover:shadow-xl transition-shadow",3,"click",4,"ngFor","ngForOf"],[1,"cursor-pointer","hover:shadow-xl","transition-shadow",3,"click"],["mat-card-image","","loading","lazy",1,"h-48","object-cover",3,"src","alt"],[1,"p-3"],[1,"font-semibold","text-base","mb-1","line-clamp-2"],[1,"text-sm","text-gray-600","mb-2","line-clamp-1"],[1,"flex","items-center","justify-between"],[1,"text-xs",3,"color"],["class","text-xs text-gray-500",4,"ngIf"],[1,"p-3","pt-0"],["mat-button","","color","primary",1,"w-full"],[1,"text-xs","text-gray-500"]],template:function(i,r){i&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),s(3,"My Library"),o(),n(4,"button",3),d("click",function(){return r.goToSearch()}),n(5,"mat-icon"),s(6,"add"),o(),s(7," Add Books "),o()(),u(8,lt,1,0,"app-loading-spinner",4)(9,ct,3,2,"div",5)(10,mt,11,0,"div",6)(11,pt,7,0,"div",6)(12,ht,7,5,"div",4),o()),i&2&&(a(8),l("ngIf",r.isLoading),a(),l("ngIf",!r.isLoading&&r.allBooks.length>0),a(),l("ngIf",!r.isLoading&&r.allBooks.length===0),a(),l("ngIf",!r.isLoading&&r.allBooks.length>0&&r.filteredBooks.length===0),a(),l("ngIf",!r.isLoading&&r.filteredBooks.length>0))},dependencies:[b,v,E,F,M,N,D,U,P,$,j,R,B,W,G,et,it]})}}return e})();export{Ht as LibraryComponent};
