# Implementation Plan: Reading Log

**Branch**: `001-reading-log` | **Date**: 2025-11-08 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/001-reading-log/spec.md`

**Note**: This plan is generated by the `/speckit.plan` command. See `.specify/templates/commands/plan.md` for the execution workflow.

## Summary

NCN Books Reading Log is a statistics-focused book tracking application that allows users to add books via search, track reading status and progress, view comprehensive statistics and graphs, and export/import data. The application will be built as a static Angular website deployed on GitHub Pages with all data stored client-side in browser storage (IndexedDB), requiring no backend infrastructure.

**Technical Approach**: Single-page Angular application using Angular 17+, TypeScript, RxJS for state management, IndexedDB (via Dexie.js) for local data persistence, and Chart.js/ng2-charts for data visualization. Book metadata sourced from Google Books API (primary) with Open Library API fallback. Fully static deployment to GitHub Pages with no server-side components.

## Technical Context

**Language/Version**: TypeScript 5.x with Angular 17+ (standalone components)
**Primary Dependencies**:
- Angular 17+ (framework)
- RxJS 7.x (reactive state management)
- Dexie.js 3.x (IndexedDB wrapper)
- Chart.js 4.x + ng2-charts (data visualization)
- Angular Material 17+ (UI components)
- Tailwind CSS 3.x (utility styling)

**Storage**: IndexedDB via Dexie.js for structured book data; localStorage for user preferences (reading speed, sort order)

**Testing**:
- Jasmine + Karma (unit tests for services, components)
- Angular Testing Library (component integration tests)
- Cypress (E2E tests for critical user journeys)

**Target Platform**:
- Web browsers (Chrome 90+, Firefox 88+, Safari 14+, Edge 90+)
- Desktop and mobile responsive (min-width: 320px)
- GitHub Pages static hosting (no server-side rendering)

**Project Type**: Single-page web application (SPA)

**Performance Goals**:
- Initial load: <2s on 4G connection
- Book search API response: <3s for 95% of queries
- Statistics dashboard render: <2s for up to 1,000 books
- Smooth 60fps scrolling and interactions

**Constraints**:
- No backend server or database infrastructure
- All data operations client-side only
- API calls directly from browser (CORS-compatible endpoints)
- Static file deployment to GitHub Pages
- Browser storage quota limits (~50MB-1GB depending on browser)
- Offline-capable for viewing existing data (with service worker for PWA features)

**Scale/Scope**:
- Single user per browser instance
- Support up to 1,000 books in reading log
- Up to 5,000 notes across all books
- Export file size up to 5MB (JSON format)

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

Verify compliance with NCN Books Constitution (`.specify/memory/constitution.md`):

- [x] **User-Centered Design**: Yes - Feature solves clear user problem (book tracking with statistics focus); UX designed for minimal clicks to add books (title-only search), intuitive status updates, and visual statistics dashboards
- [x] **Data Integrity First**: Yes - All data operations use IndexedDB transactions; export/import provides backup/recovery; ISBN-based duplicate detection; validation before persistence
- [x] **Incremental Progress**: Yes - Can be broken into 4 deliverable stages (P1: Add books, P2: Track status, P3: Statistics, P4: Export/Import), each completable within 1-2 days
- [x] **Simplicity & Clarity**: Yes - Standard Angular SPA architecture; browser storage (no backend complexity); uses well-documented libraries (Angular Material, Dexie.js, Chart.js); no custom abstractions
- [x] **Quality Through Testing**: Yes - Critical paths identified: book search/add, status updates, IndexedDB operations, export/import; unit tests for services, integration tests for components, E2E for user journeys

**All gates passed** ✅ - No violations requiring justification.

## Project Structure

### Documentation (this feature)

```text
specs/001-reading-log/
├── plan.md              # This file (/speckit.plan command output)
├── research.md          # Phase 0 output (Angular + IndexedDB best practices)
├── data-model.md        # Phase 1 output (IndexedDB schema design)
├── quickstart.md        # Phase 1 output (dev environment setup)
├── contracts/           # Phase 1 output (API integration specs)
│   ├── google-books-api.md
│   └── open-library-api.md
└── tasks.md             # Phase 2 output (/speckit.tasks command)
```

### Source Code (repository root)

```text
# Angular single-page application structure
src/
├── app/
│   ├── core/                    # Singleton services, guards, interceptors
│   │   ├── services/
│   │   │   ├── book-api.service.ts          # Google Books + Open Library integration
│   │   │   ├── storage.service.ts           # IndexedDB abstraction (Dexie.js)
│   │   │   ├── reading-log.service.ts       # Business logic for reading entries
│   │   │   ├── statistics.service.ts        # Stats calculations
│   │   │   └── export-import.service.ts     # Data export/import
│   │   └── models/
│   │       ├── book.model.ts
│   │       ├── reading-entry.model.ts
│   │       ├── note.model.ts
│   │       └── user-preferences.model.ts
│   │
│   ├── features/                # Feature modules (lazy-loaded)
│   │   ├── library/
│   │   │   ├── library.component.ts         # Main book list view
│   │   │   ├── book-card.component.ts       # Individual book display
│   │   │   ├── filter-bar.component.ts      # Status filtering
│   │   │   └── sort-selector.component.ts   # Sort options
│   │   │
│   │   ├── book-search/
│   │   │   ├── search.component.ts          # Search input + results
│   │   │   ├── search-results.component.ts  # Results list with pagination
│   │   │   └── manual-entry.component.ts    # Manual book entry form
│   │   │
│   │   ├── book-detail/
│   │   │   ├── detail.component.ts          # Book detail view
│   │   │   ├── status-selector.component.ts # Status dropdown
│   │   │   ├── notes-section.component.ts   # Notes list + add/edit
│   │   │   └── book-stats.component.ts      # Individual book statistics
│   │   │
│   │   ├── statistics/
│   │   │   ├── dashboard.component.ts       # Main stats dashboard
│   │   │   ├── overview-card.component.ts   # Summary metrics
│   │   │   ├── pie-chart.component.ts       # Status distribution
│   │   │   ├── trend-chart.component.ts     # Reading trends over time
│   │   │   └── metrics-panel.component.ts   # Detailed metrics display
│   │   │
│   │   └── settings/
│   │       ├── settings.component.ts        # App settings
│   │       ├── export-panel.component.ts    # Export functionality
│   │       └── import-panel.component.ts    # Import with conflict resolution
│   │
│   ├── shared/                  # Reusable components, directives, pipes
│   │   ├── components/
│   │   │   ├── loading-spinner.component.ts
│   │   │   ├── error-message.component.ts
│   │   │   └── confirmation-dialog.component.ts
│   │   ├── pipes/
│   │   │   ├── reading-time.pipe.ts         # Calculate estimated reading time
│   │   │   └── dimension-unit.pipe.ts       # Convert cm <-> inches
│   │   └── directives/
│   │       └── auto-focus.directive.ts
│   │
│   ├── app.component.ts         # Root component
│   ├── app.routes.ts            # Route configuration
│   └── app.config.ts            # App-level providers
│
├── assets/
│   ├── icons/                   # SVG icons
│   └── images/                  # Placeholder images
│
├── environments/
│   ├── environment.ts           # Dev environment
│   └── environment.prod.ts      # Prod environment (GitHub Pages)
│
├── styles/
│   ├── styles.scss              # Global styles
│   └── tailwind.config.js       # Tailwind configuration
│
└── index.html                   # SPA entry point

# Configuration files (repository root)
angular.json                     # Angular workspace config
package.json                     # Dependencies
tsconfig.json                    # TypeScript config
karma.conf.js                    # Test runner config
cypress.config.ts                # E2E test config
tailwind.config.js               # Tailwind CSS config
.github/
└── workflows/
    └── deploy.yml               # GitHub Actions for Pages deployment

# Tests
src/app/
├── **/*.spec.ts                 # Unit + integration tests (co-located)
cypress/
├── e2e/
│   ├── book-search.cy.ts        # E2E: Search and add books
│   ├── reading-status.cy.ts     # E2E: Update status, add notes
│   ├── statistics.cy.ts         # E2E: View statistics
│   └── export-import.cy.ts      # E2E: Export/import data
└── support/
    └── commands.ts              # Custom Cypress commands
```

**Structure Decision**: Selected **Single-page web application** structure with Angular 17+ standalone components architecture. All feature modules are organized by domain (library, search, detail, statistics, settings) to support incremental development and lazy loading. Core services centralized for reusability. Tests co-located with implementation files for unit/integration tests; E2E tests in separate Cypress directory.

## Complexity Tracking

> **Fill ONLY if Constitution Check has violations that must be justified**

No violations detected - Constitution Check passed all gates. This section intentionally left empty.

